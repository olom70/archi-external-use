from dash import Dash
import logging

import archi.parsexml as parsexml
import archi.creategraphs as creategraphs
import archi.configarchi as conf
import archi.exploitgraph as exploitgraph


if __name__ == '__main__':

    logger = logging.getLogger('archi-external-use')
    logger.setLevel(logging.WARNING)
    fh = logging.FileHandler(filename='test-archi-external-use.log')
    fh.setLevel(logging.WARNING)
    formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
    fh.setFormatter(formatter)
    logger.addHandler(fh)
    logger.info('Start. Application is initializing')

    fileToRead = 'tinker.xml'
    
    content = parsexml.readModel(fileToRead)
    viewIdentifier = 'id-14c9a667d06949e49b10686750cf5cac'
    viewAsGraph = creategraphs.createGraphView(viewIdentifier, content)
    lists: conf.Lists
    lists = exploitgraph.prepareBusinessCapabilitiesTreemap(viewAsGraph)

    app = Dash(__name__)
    exploitgraph.callDashtreemap(app, lists)
    app.run_server(debug=True)
